{"version":3,"sources":["index.js"],"names":["LiveSearchForm","props","_this","Object","_Users_konstantinzaytsev_Documents_GitHub_react_live_search_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","this","_Users_konstantinzaytsev_Documents_GitHub_react_live_search_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__","_Users_konstantinzaytsev_Documents_GitHub_react_live_search_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__","call","state","searchString","results","items","handleChange","bind","_Users_konstantinzaytsev_Documents_GitHub_react_live_search_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_5__","handleEnter","setWrapperRef","handleClickOutside","document","addEventListener","removeEventListener","node","wrapperRef","event","contains","target","setState","_this2","value","length","axios","get","concat","then","_ref","data","keyCode","window","location","href","isHidden","total","list","react__WEBPACK_IMPORTED_MODULE_6___default","a","createElement","className","map","item","index","key","url","alt","src","image","name","price","ref","placeholder","type","onChange","onKeyUp","React","Component","rootElement","getElementById","ReactDOM","render"],"mappings":"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","file":"static/js/main.b1f7e79c.chunk.js","sourcesContent":["import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport axios from \"axios\";\n\nimport \"./styles.css\";\n\nclass LiveSearchForm extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      searchString: \"\",\n      results: {\n        items: []\n      }\n    };\n    this.handleChange = this.handleChange.bind(this);\n    this.handleEnter = this.handleEnter.bind(this);\n    this.setWrapperRef = this.setWrapperRef.bind(this);\n    this.handleClickOutside = this.handleClickOutside.bind(this);\n  }\n\n  componentDidMount() {\n    document.addEventListener('mousedown', this.handleClickOutside);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('mousedown', this.handleClickOutside);\n  }\n\n  setWrapperRef(node) {\n    this.wrapperRef = node;\n  }\n\n  handleClickOutside(event) {\n    if (this.wrapperRef && !this.wrapperRef.contains(event.target)) {\n      this.setState({ results: {items: []} });\n    }\n  }\n\n  handleChange(event) {\n    this.setState({ searchString: event.target.value });\n    if(event.target.value.length < 3) {\n      this.setState({ results: {items: []} });\n      return;\n    }\n    axios.get(`http://new.stocvetov.ru/dev/search.php?query_string=${event.target.value}`).then(({ data }) => {\n      this.setState({ results: data });\n    });\n  }\n\n  handleEnter(event) {\n    if (event.keyCode === 13) {\n      window.location.href = `/catalog-of-product/?search_string=${this.state.searchString}`;\n    }\n  }\n\n  render() {\n\n    let isHidden = this.state.results.items.length === 4 && this.state.results.total > 4 ? '' : 'hidden';\n\n    let list = '';\n    if (this.state.results.items.length > 0) {\n      list =\n      <ul className=\"live-search__list\">\n        {this.state.results.items.map((item, index) => (\n          <li key={index} className=\"live-search__list__item\">\n            <a href={item.url}>\n              <div className=\"live-search__list__item__image\">\n                <img alt=\"\" src={`http://new.stocvetov.ru${item.image}`} />\n              </div>\n              <div className=\"live-search__list__item__name\">{item.name}</div>\n              <div className=\"live-search__list__item__price\">{item.price}&nbsp;₽</div>\n            </a>\n          </li>\n        ))}\n        <li className={isHidden}>\n          <a href={`/catalog-of-product/?search_string=${this.state.searchString}`}>Все результаты</a>\n        </li>\n      </ul>;\n    }\n\n    return (\n      <div className=\"live-search__container\" ref={this.setWrapperRef}>\n        <input\n          className=\"live-search__input\"\n          placeholder=\"Поиск по сайту\"\n          type=\"text\"\n          value={this.state.searchString}\n          onChange={this.handleChange}\n          onKeyUp={this.handleEnter}\n        />\n        <div>\n          {list}\n        </div>\n      </div>\n    );\n  }\n}\n\nconst rootElement = document.getElementById(\"live-search\");\nReactDOM.render(<LiveSearchForm />, rootElement);\n"],"sourceRoot":""}